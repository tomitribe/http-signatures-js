!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("crypto")):"function"==typeof define&&define.amd?define(["exports","crypto"],e):e((t=t||self).httpSignaturesJs={},t.crypto)}(this,function(t,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var i=function(t){function e(e,r){var n=t.call(this,e)||this;return n.cause=r,n}return n(e,t),e}(Error),o=function(t){function e(e,r){return t.call(this,e,r)||this}return n(e,t),e}(i),a=function(t){function e(e,r){return t.call(this,e,r)||this}return n(e,t),e}(o),u=function(){function t(e,r,n){this.portableName=e,this.jmvName=r,this.type=n,t.values.push(this),t.aliases[t.normalize(e)]=this,t.aliases[t.normalize(r)]=this}return t.prototype.getPortableName=function(){return this.portableName},t.prototype.getJmvName=function(){return this.jmvName},t.prototype.getType=function(){return this.type},t.getValues=function(){return t.values||[]},t.getAliases=function(){return t.aliases||{}},t.toPortableName=function(e){return t.get(e).getPortableName()},t.toJvmName=function(e){return t.get(e).getJmvName()},t.get=function(e){var r=t.getAliases()[t.normalize(e)];if(null!=r)return r;throw new a(e)},t.normalize=function(t){return t.replace(new RegExp("[^A-Za-z0-9]+","g"),"").toLowerCase()},t.prototype.toString=function(){return this.getPortableName()},t.values=[],t.aliases={},t.HMAC_SHA1=new t("HmacSHA1","hmac-sha1","Mac.class"),t.HMAC_SHA224=new t("HmacSHA224","hmac-sha224","Mac.class"),t.HMAC_SHA256=new t("HmacSHA256","hmac-sha256","Mac.class"),t.HMAC_SHA384=new t("HmacSHA384","hmac-sha384","Mac.class"),t.HMAC_SHA512=new t("HmacSHA512","hmac-sha512","Mac.class"),t.RSA_SHA1=new t("SHA1withRSA","rsa-sha1","java.security.Signature.class"),t.RSA_SHA256=new t("SHA256withRSA","rsa-sha256","java.security.Signature.class"),t.RSA_SHA384=new t("SHA384withRSA","rsa-sha384","java.security.Signature.class"),t.RSA_SHA512=new t("SHA512withRSA","rsa-sha512","java.security.Signature.class"),t.DSA_SHA1=new t("SHA1withDSA","dsa-sha1","java.security.Signature.class"),t.DSA_SHA224=new t("SHA224withDSA","dsa-sha224","java.security.Signature.class"),t.DSA_SHA256=new t("SHA256withDSA","dsa-sha256","java.security.Signature.class"),t.ECDSA_SHA1=new t("SHA1withECDSA","ecdsa-sha1","java.security.Signature.class"),t.ECDSA_SHA256=new t("SHA256withECDSA","ecdsa-sha256","java.security.Signature.class"),t.ECDSA_SHA384=new t("SHA384withECDSA","ecdsa-sha384","java.security.Signature.class"),t.ECDSA_SHA512=new t("SHA512withECDSA","ecdsa-sha512","java.security.Signature.class"),t}(),s=function(){function t(){}return t.arraycopy=function(t,e,r,n,i){if(t!==r||n>=e+i)for(;--i>=0;)r[n++]=t[e++];else for(var o=t.slice(e,e+i),a=0;a<i;a++)r[n++]=o[a]},t}(),c=function(){function t(){}return Object.defineProperty(t,"base64Alphabet",{get:function(){for(var e=[],r=0;r<t.BASELENGTH;r++)e[r]=-1;for(r="Z".charCodeAt(0);r>="A".charCodeAt(0);r--)e[r]=r-"A".charCodeAt(0)|0;for(r="z".charCodeAt(0);r>="a".charCodeAt(0);r--)e[r]=r-"a".charCodeAt(0)+26|0;for(r="9".charCodeAt(0);r>="0".charCodeAt(0);r--)e[r]=r-"0".charCodeAt(0)+52|0;return e["+".charCodeAt(0)]=62,e["/".charCodeAt(0)]=63,e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"lookUpBase64Alphabet",{get:function(){for(var t=[],e=0;e<=25;e++)t[e]="A".charCodeAt(0)+e|0;e=26;for(var r=0;e<=51;e++,r++)t[e]="a".charCodeAt(0)+r|0;for(e=52,r=0;e<=61;e++,r++)t[e]="0".charCodeAt(0)+r|0;return t[62]="+".charCodeAt(0),t[63]="/".charCodeAt(0),t},enumerable:!0,configurable:!0}),t.isBase64=function(e){return e===t.PAD||!(e<0||-1===t.base64Alphabet[e])},t.encodeBase64=function(e,r){void 0===r&&(r=!1);var n,i=e.length*t.EIGHTBIT,o=i%t.TWENTYFOURBITGROUP,a=i/t.TWENTYFOURBITGROUP|0,u=0,c=0;u=0!==o?4*(a+1):4*a,r&&(u+=(c=0===t.CHUNK_SEPARATOR.length?0:0|Math.ceil(u/t.CHUNK_SIZE))*t.CHUNK_SEPARATOR.length),n=[];var f,h=0,l=0,p=0,g=0,S=0,d=0,E=0,A=t.CHUNK_SIZE,v=0;for(f=0;f<a;f++){p=e[E=3*f],g=e[E+1],S=e[E+2],l=15&g|0,h=3&p|0;var y=0==(p&t.SIGN)?p>>2|0:p>>2^192|0,m=0==(g&t.SIGN)?g>>4|0:g>>4^240|0,b=0==(S&t.SIGN)?S>>6|0:S>>6^252|0;n[d]=t.lookUpBase64Alphabet[y],n[d+1]=t.lookUpBase64Alphabet[m|h<<4],n[d+2]=t.lookUpBase64Alphabet[l<<2|b],n[d+3]=t.lookUpBase64Alphabet[63&S],d+=4,r&&d===A&&(s.arraycopy(t.CHUNK_SEPARATOR,0,n,d,t.CHUNK_SEPARATOR.length),v++,A=t.CHUNK_SIZE*(v+1)+v*t.CHUNK_SEPARATOR.length,d+=t.CHUNK_SEPARATOR.length)}if(E=3*f,o===t.EIGHTBIT){h=3&(p=e[E])|0;y=0==(p&t.SIGN)?p>>2|0:p>>2^192|0;n[d]=t.lookUpBase64Alphabet[y],n[d+1]=t.lookUpBase64Alphabet[h<<4],n[d+2]=t.PAD,n[d+3]=t.PAD}else if(o===t.SIXTEENBIT){p=e[E],l=15&(g=e[E+1])|0,h=3&p|0;y=0==(p&t.SIGN)?p>>2|0:p>>2^192|0,m=0==(g&t.SIGN)?g>>4|0:g>>4^240|0;n[d]=t.lookUpBase64Alphabet[y],n[d+1]=t.lookUpBase64Alphabet[m|h<<4],n[d+2]=t.lookUpBase64Alphabet[l<<2],n[d+3]=t.PAD}return r&&v<c&&s.arraycopy(t.CHUNK_SEPARATOR,0,n,u-t.CHUNK_SEPARATOR.length,t.CHUNK_SEPARATOR.length),n},t.decodeBase64=function(e){if(0===(e=t.discardNonBase64(e)).length)return[];for(var r,n=e.length/t.FOURBYTE|0,i=0,o=0,a=0,u=0,s=0,c=0,f=0,h=0,l=e.length;e[l-1]===t.PAD;)if(0==--l)return[];r=[];for(var p=0;p<n;p++)s=e[(h=4*p)+2],c=e[h+3],i=t.base64Alphabet[e[h]],o=t.base64Alphabet[e[h+1]],s!==t.PAD&&c!==t.PAD?(a=t.base64Alphabet[s],u=t.base64Alphabet[c],r[f]=i<<2|o>>4|0,r[f+1]=(15&o)<<4|a>>2&15|0,r[f+2]=a<<6|u|0):s===t.PAD?r[f]=i<<2|o>>4|0:c===t.PAD&&(a=t.base64Alphabet[s],r[f]=i<<2|o>>4|0,r[f+1]=(15&o)<<4|a>>2&15|0),f+=3;return r},t.discardNonBase64=function(e){for(var r=[],n=0,i=0;i<e.length;i++)t.isBase64(e[i])&&(r[n++]=e[i]);var o=[];return s.arraycopy(r,0,o,0,n),o},t.CHUNK_SIZE=76,t.CHUNK_SEPARATOR="\r\n".split("").map(function(t){return t.charCodeAt(0)}),t.BASELENGTH=255,t.LOOKUPLENGTH=64,t.EIGHTBIT=8,t.SIXTEENBIT=16,t.TWENTYFOURBITGROUP=24,t.FOURBYTE=4,t.SIGN=-128,t.PAD="=".charCodeAt(0),t}(),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(Array);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var h,l=function(t,e){return t(e={exports:{}},e.exports),e.exports}(function(t,r){!function(t,e){e=e&&e.hasOwnProperty("default")?e.default:e;var r=function(){function t(t){this.buf=[+t||0]}return t.prototype.mulAdd=function(t,e){var r,n,i=this.buf,o=i.length;for(r=0;r<o;++r)(n=i[r]*t+e)<1e13?e=0:n-=1e13*(e=0|n/1e13),i[r]=n;e>0&&(i[r]=e)},t.prototype.sub=function(t){var e,r,n=this.buf,i=n.length;for(e=0;e<i;++e)(r=n[e]-t)<0?(r+=1e13,t=1):t=0,n[e]=r;for(;0===n[n.length-1];)n.pop()},t.prototype.toString=function(t){if(10!=(t||10))throw"only base 10 is supported";for(var e=this.buf,r=e[e.length-1].toString(),n=e.length-2;n>=0;--n)r+=(1e13+e[n]).toString().substring(1);return r},t.prototype.valueOf=function(){for(var t=this.buf,e=0,r=t.length-1;r>=0;--r)e=1e13*e+t[r];return e},t.prototype.simplify=function(){var t=this.buf;return 1==t.length?t[0]:this},t}(),n="Illegal argument specified!";function i(t,e){return t+("0"+e.toString(16)).slice(-2)}function o(t){return 0===t[0]?o(t.slice(1)):t}function a(t){if(!t)throw new Error(n);var e=t.match(/[0-9A-F]{2}/gi);if(!e)throw new Error(n);return new Uint8Array(e.map(function(t){return parseInt(t,16)}))}function u(t){try{return Promise.resolve(t())}catch(t){return Promise.reject(t)}}function s(t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}function c(t){return t instanceof ArrayBuffer&&(t=new Uint8Array(t)),String.fromCharCode.apply(String,t)}function f(t){try{if("object"==typeof window&&"function"==typeof window.atob)return window.atob(t);if("undefined"!=typeof Buffer)return Buffer.from(t,"base64").toString("binary");throw new Error(n)}catch(t){throw new Error(t)}}function h(t){if("string"!=typeof t||t.length%4!=0)throw new Error(n);return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function l(t){if("string"!=typeof t||t.length%4==1)throw new Error(n);for(;t.length%4!=0;)t+="=";return t.replace(/\-/g,"+").replace(/_/g,"/")}function p(t){return f(l(t))}function g(t){try{if("object"==typeof window&&"function"==typeof window.atob)return window.btoa(t);if("undefined"!=typeof Buffer)return Buffer.from(t).toString("base64");throw new Error(n)}catch(t){throw new Error(t)}}function S(t){return h(g(t))}var d="â€¦",E=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,A=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function v(t,e){return t.length>e&&(t=t.substring(0,e)+d),t}var y=function(){function t(e,r){void 0===r&&(r=0),this.hexDigits="0123456789ABCDEF",e instanceof t?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=r)}return t.prototype.get=function(t){if(void 0===t&&(t=this.pos++),t>=this.enc.length)throw"Requesting byte offset "+t+" on a stream of length "+this.enc.length;return"string"==typeof this.enc?this.enc.charCodeAt(t):this.enc[t]},t.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},t.prototype.hexDump=function(t,e,r){for(var n="",i=t;i<e;++i)if(n+=this.hexByte(this.get(i)),!0!==r)switch(15&i){case 7:n+="  ";break;case 15:n+="\n";break;default:n+=" "}return n},t.prototype.isASCII=function(t,e){for(var r=t;r<e;++r){var n=this.get(r);if(n<32||n>176)return!1}return!0},t.prototype.parseStringISO=function(t,e){for(var r="",n=t;n<e;++n)r+=String.fromCharCode(this.get(n));return r},t.prototype.parseStringUTF=function(t,e){for(var r="",n=t;n<e;){var i=this.get(n++);r+=i<128?String.fromCharCode(i):i>191&&i<224?String.fromCharCode((31&i)<<6|63&this.get(n++)):String.fromCharCode((15&i)<<12|(63&this.get(n++))<<6|63&this.get(n++))}return r},t.prototype.parseStringBMP=function(t,e){for(var r,n,i="",o=t;o<e;)r=this.get(o++),n=this.get(o++),i+=String.fromCharCode(r<<8|n);return i},t.prototype.parseTime=function(t,e,r){var n=this.parseStringISO(t,e),i=(r?E:A).exec(n);if(!i)return"Unrecognized time: "+n;if(r){var o=+i[1]<70?2e3:1900;i[1]=o+""}return n=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(n+=":"+i[5],i[6]&&(n+=":"+i[6],i[7]&&(n+="."+i[7]))),i[8]&&(n+=" UTC","Z"!=i[8]&&(n+=i[8],i[9]&&(n+=":"+i[9]))),n},t.prototype.parseInteger=function(t,e){for(var n,i=this.get(t),o=i>127,a=o?255:0,u="";i==a&&++t<e;)i=this.get(t);if(0==(n=e-t))return o?-1:0;if(n>4){var s=+i;for(n<<=3;0==(128&(s^a));)s<<=1,--n;u="("+n+" bit)\n"}o&&(i-=256);for(var c=new r(i),f=t+1;f<e;++f)c.mulAdd(256,this.get(f));return u+c.toString()},t.prototype.parseBitString=function(t,e,r){for(var n=this.get(t),i="("+((e-t-1<<3)-n)+" bit)\n",o="",a=t+1;a<e;++a){for(var u=this.get(a),s=a==e-1?n:0,c=7;c>=s;--c)o+=u>>c&1?"1":"0";if(o.length>r)return i+v(o,r)}return i+o},t.prototype.parseOctetString=function(t,e,r){if(this.isASCII(t,e))return v(this.parseStringISO(t,e),r);var n=e-t,i="("+n+" byte)\n";n>(r/=2)&&(e=t+r);for(var o=t;o<e;++o)i+=this.hexByte(this.get(o));return n>r&&(i+=d),i},t.prototype.parseOID=function(t,e,n){for(var i="",o=new r,a=0,u=t;u<e;++u){var s=this.get(u);if(o.mulAdd(128,127&s),a+=7,!(128&s)){if(""===i)if((o=o.simplify())instanceof r)o.sub(80),i="2."+o.toString();else{var c=o<80?o<40?0:1:2;i=c+"."+(o-40*c)}else i+="."+o.toString();if(i.length>n)return v(i,n);o=new r,a=0}}return a>0&&(i+=".incomplete"),i},t}(),m=function(){function t(t,e,r,n,i){if(!(n instanceof b))throw"Invalid tag value.";this.stream=t,this.header=e,this.length=r,this.tag=n,this.sub=i}return t.decodeLength=function(t){var e=t.get(),r=127&e;if(r==e)return r;if(r>6)throw"Length over 48 bits not supported at position "+(t.pos-1);if(0===r)return null;e=0;for(var n=0;n<r;++n)e=256*e+t.get();return e},t.decode=function(e){e instanceof y||(e=new y(e,0));var r=new y(e),n=new b(e),i=t.decodeLength(e),o=null,a=e.pos,u=a-r.pos,s=function(){if(o=[],null!==i){for(var r=a+i;e.pos<r;)o[o.length]=t.decode(e);if(e.pos!=r)throw"Content size is not correct for container starting at offset "+a}else try{for(;;){var n=t.decode(e);if(n.tag.isEOC())break;o[o.length]=n}i=a-e.pos}catch(t){throw"Exception while decoding undefined length content: "+t}};if(n.tagConstructed)s();else if(n.isUniversal()&&(3==n.tagNumber||4==n.tagNumber))try{if(3==n.tagNumber&&0!=e.get())throw"BIT STRINGs with unused bits cannot encapsulate.";s();for(var c=0;c<o.length;++c)if(o[c].tag.isEOC())throw"EOC is not supposed to be actual content."}catch(t){o=null}if(null===o){if(null===i)throw"We can't skip over an invalid tag with undefined length at offset "+a;e.pos=a+Math.abs(i)}return new t(r,u,i,n,o)},t.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},t.prototype.content=function(t){if(void 0===this.tag)return null;void 0===t&&(t=1/0);var e=this.posContent(),r=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+r,t);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(e)?"false":"true";case 2:return this.stream.parseInteger(e,e+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+r,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+r,t);case 6:return this.stream.parseOID(e,e+r,t);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return v(this.stream.parseStringUTF(e,e+r),t);case 18:case 19:case 20:case 21:case 22:case 26:return v(this.stream.parseStringISO(e,e+r),t);case 30:return v(this.stream.parseStringBMP(e,e+r),t);case 23:case 24:return this.stream.parseTime(e,e+r,23==this.tag.tagNumber)}return null},t.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},t.prototype.posStart=function(){return this.stream.pos},t.prototype.posContent=function(){return this.stream.pos+this.header},t.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},t.prototype.toHexString=function(t){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},t.prototype.getHex=function(){return this.stream.hexDump(this.posContent(),this.posEnd(),!0)},t.prototype.getAB=function(t){return void 0===t&&(t=!0),t?o(a(this.getHex())):a(this.getHex())},t}(),b=function(){function t(t){var e=t.get();if(this.tagClass=e>>6,this.tagConstructed=0!=(32&e),this.tagNumber=31&e,31==this.tagNumber){var n=new r;do{e=t.get(),n.mulAdd(128,127&e)}while(128&e);this.tagNumber=n.simplify()}}return t.prototype.isUniversal=function(){return 0===this.tagClass},t.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},t}(),w=function(t){var e=this;if("string"!=typeof t)throw new Error(n);this.type="public";var r=t.split("\n"),i=["-BEGIN PRIVATE KEY-","-END PRIVATE KEY-","-BEGIN EC PRIVATE KEY-","-END EC PRIVATE KEY-","-BEGIN RSA PRIVATE KEY-","-END RSA PRIVATE KEY-"],o=["-BEGIN RSA PUBLIC KEY-","-BEGIN EC PUBLIC KEY-","-BEGIN PUBLIC KEY-","-END PUBLIC KEY-","-END EC PUBLIC KEY-","-END RSA PUBLIC KEY-"],a=r.map(function(t){return t.trim()}).filter(function(t){return t.length&&function(t){return i.some(function(e){return t.toUpperCase().indexOf(e)>-1})?(e.type="private",!1):!o.some(function(e){return t.toUpperCase().indexOf(e)>-1})}(t)}).join("");if(a.length)return this.body=s(f(l(a))),this;throw new Error(n)},C=[{name:"p-256",curve:"1.2.840.10045.3.1.7",coordinateLength:32},{name:"p-384",curve:"1.3.132.0.34",coordinateLength:48},{name:"p-384",curve:"1.3.132.0.35",coordinateLength:66}],N=function(){function t(){}return t.ASN1fromPEM=function(t){if(!t)throw new Error(n);t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=m.decode(t),r={};return 3===e.sub.length?(r.version=e.sub[0].content(),r.keyType=e.sub[1].sub[0].content(),r.namedCurve=e.sub[1].sub[1].content(),r.versionSub=e.sub[2].sub[0].sub[0].content(),r.privateKey=e.sub[2].sub[0].sub[2].getAB(),r.curveTypeSub=e.sub[2].sub[0].sub[2].sub[0].content(),r.publicKey=e.sub[2].sub[0].sub[3].sub[0].getAB()):2===e.sub.length&&(r.keyType=e.sub[0].sub[0].content(),r.namedCurve=e.sub[0].sub[1].content(),r.publicKey=e.sub[1].getAB()),e},t.JWKfromASN1=function(t,e,r){if(!t)throw new Error(n);if("private"===(e="string"==typeof e&&e.toLowerCase()||["public","private"][t.privateKey?1:0])&&!t.privateKey)throw new Error(n);var i=C.find(function(e){return e.curve===t.namedCurve});if(!i)throw new Error(n);var o=t.publicKey;if(4!==o.readInt8(0))throw new Error(n);var a=Object.assign({kty:"EC",crv:i.name},r,{x:S(c(o.slice(1,i.coordinateLength))),y:S(c(o.slice(i.coordinateLength+1,2*(i.coordinateLength+1))))});return"private"===e&&Object.assign(a,{d:S(c(t.privateKey))}),a},t.JWKfromEC=function(e,r,n){return u(function(){var i=new w(e);return t.JWKfromASN1(t.ASN1fromPEM(i.body),r,n)})},t}();function O(t,e,r,n){return new(r||(r=Promise))(function(i,o){function a(t){try{s(n.next(t))}catch(t){o(t)}}function u(t){try{s(n.throw(t))}catch(t){o(t)}}function s(t){t.done?i(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})}function I(t,e){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var R="object"==typeof window&&(window.crypto||window.msCrypto),D=R&&(R.subtle||R.webkitSubtle||R.Subtle),M=function(){function t(){}return t.createSigner=function(t,r){return O(this,void 0,void 0,function(){var n;return I(this,function(i){return D?(n=s(r),[2,D.importKey("raw",n,{name:"HMAC",hash:{name:t}},!0,["sign"]).then(function(t){return{update:function(e){return O(this,void 0,void 0,function(){return I(this,function(r){return[2,D.sign("HMAC",t,s(e))]})})}}})]):[2,e&&e.createHmac?Promise.resolve(e.createHmac(t.replace("SHA-","sha"),r)):Promise.reject(R)]})})},t.sign=function(e){return function(r,n){return O(this,void 0,void 0,function(){var i,o,a,u,s,f,l;return I(this,function(p){switch(p.label){case 0:return[4,t.createSigner("SHA-"+e,n)];case 1:return i=p.sent(),a=(o=Promise).resolve,D?(s=S,f=c,(l=i)?[4,i.update(r)]:[3,3]):[3,4];case 2:l=p.sent(),p.label=3;case 3:return u=s.apply(void 0,[f.apply(void 0,[l])]),[3,5];case 4:u=h(i&&i.update(r).digest("base64")),p.label=5;case 5:return[2,a.apply(o,[u])]}})})}},t.verify=function(e){return function(r,n,i){return O(this,void 0,void 0,function(){return I(this,function(o){switch(o.label){case 0:return[4,t.sign(e)(r,i)];case 1:return[2,o.sent()===n]}})})}},t}(),P="object"==typeof window&&(window.crypto||window.msCrypto),H=P&&(P.subtle||P.webkitSubtle||P.Subtle),B=function(){function t(){}return t.ASN1fromPEM=function(t){if(!t)throw new Error(n);t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=m.decode(t),r={};if(3===e.sub.length&&(e=e.sub[2].sub[0]),9===e.sub.length?(r.modulus=e.sub[1].getAB(),r.publicExponent=parseInt(e.sub[2].getHex(),16),r.privateExponent=e.sub[3].getAB(),r.prime1=e.sub[4].getAB(),r.prime2=e.sub[5].getAB(),r.exponent1=e.sub[6].getAB(),r.exponent2=e.sub[7].getAB(),r.coefficient=e.sub[8].getAB()):2===e.sub.length&&(e=e.sub[1].sub[0],r.modulus=e.sub[0].getAB(),r.publicExponent=parseInt(e.sub[1].getHex(),16)),r.bits=8*(r.modulus.length-1)+Math.ceil(Math.log(r.modulus[0]+1)/Math.log(2)),!r.bits)throw new Error(n);return r},t.JWKfromASN1=function(t,e,r){if(!t)throw new Error(n);if("private"===(e="string"==typeof e&&e.toLowerCase()||["public","private"][t.privateExponent?1:0])&&!t.privateExponent)throw new Error(n);var i=t.publicExponent,o=Math.ceil(Math.log(i)/Math.log(256)),a=new Uint8Array(o).map(function(t){return t=i%256,i=Math.floor(i/256),t}).reverse(),u=Object.assign({kty:"RSA"},r,{n:S(c(t.modulus)),e:S(c(a))});return"private"===e&&Object.assign(u,{d:S(c(t.privateExponent)),p:S(c(t.prime1)),q:S(c(t.prime2)),dp:S(c(t.exponent1)),dq:S(c(t.exponent2)),qi:S(c(t.coefficient))}),u},t.JWKfromRSA=function(e,r,n){return u(function(){var i=new w(e);return t.JWKfromASN1(t.ASN1fromPEM(i.body),r,n)})},t.createSigner=function(r){if(H)return{update:function(e){return{sign:function(n,i){return O(this,void 0,void 0,function(){var i=this;return I(this,function(o){return[2,t.JWKfromRSA(n,"private",{key_ops:["sign"],alg:r.replace("SHA-","RS")}).then(function(t){return O(i,void 0,void 0,function(){var n=this;return I(this,function(i){return[2,H.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:r}},!0,["sign"]).then(function(t){return O(n,void 0,void 0,function(){return I(this,function(n){return[2,H.sign({name:"RSASSA-PKCS1-v1_5",hash:{name:r}},t,s(e)).then(c).then(g)]})})})]})})})]})})}}}};if(e&&e.createSign)return e.createSign(r.replace("SHA-","RSA-SHA"));throw new Error(n)},t.sign=function(e){return function(r,n){return O(this,void 0,void 0,function(){return I(this,function(i){return[2,u(function(){return t.createSigner("SHA-"+e).then(function(t){return t.update(r).sign(n,"base64").then(h)})})]})})}},t.createVerifier=function(r){if(H)return{update:function(e){return{verify:function(n,i,o){return O(this,void 0,void 0,function(){var o=this;return I(this,function(a){return[2,t.JWKfromRSA(n,"public",{key_ops:["verify"],alg:r.replace("SHA-","RS")}).then(function(t){var n=t.kty,a=t.n,u=t.e;return O(o,void 0,void 0,function(){return I(this,function(t){return[2,H.importKey("jwk",{kty:n,n:a,e:u},{name:"RSASSA-PKCS1-v1_5",hash:{name:r}},!1,["verify"]).then(function(t){return H.verify("RSASSA-PKCS1-v1_5",t,s(p(i)),s(e))})]})})})]})})}}}};if(e&&e.createVerify)return e.createVerify(r.replace("SHA-","RSA-SHA"));throw new Error(n)},t.verify=function(e){return function(r,n,i){return O(this,void 0,void 0,function(){var o;return I(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,t.createVerifier("SHA-"+e).then(function(t){return t.update(r).verify(i,l(n),"base64")})];case 1:return[2,a.sent()];case 2:return o=a.sent(),[2,Promise.reject(new Error(o.message))];case 3:return[2]}})})}},t}(),U={ASN1:m,EC:N,PEM:w,RSA:B,HMAC:M,ILLEGAL_ARGUMENT:n,UNSUPPORTED_ALGORITHM:'Unsupported algorithm name specified! Supported algorithms: "HS256", "HS384", "HS512", "RS256", "RS384", "RS512" and "none".',tryPromise:u,AB2hex:function(t){return t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t.reduce(i,"")},AB2s:c,b2bu:h,b2s:f,bu2b:l,bu2s:p,cleanZeros:o,hex2AB:a,num2hex:i,s2AB:s,s2b:g,s2bu:S};t.default=U,t.jwkJs=U,Object.defineProperty(t,"__esModule",{value:!0})}(r,e)}),p=(h=l)&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,g=function(){function t(){}return t.privateKeyFromPKCS8=function(t){try{return p.EC.JWKfromEC(p.AB2s(t),"private")}catch(t){throw new Error(t)}},t.publicKeyFrom=function(t){try{return p.EC.JWKfromEC(p.AB2s(t),"public")}catch(t){throw new Error(t)}},t.EC="EC",t.SUNEC="SunEC",t}();function S(t,e){return!!t&&!!e&&t.toUpperCase()===e.toUpperCase()}var d,E,A=function(){function t(){this.str=""}return Object.defineProperty(t.prototype,"length",{get:function(){return this.str.length},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return this.str},t.prototype.toNumber=function(){return+this.str},t.prototype.lastIndexOf=function(t){return this.str.lastIndexOf(t)},t.prototype.append=function(t){return t&&t.toString&&(this.str=this.str.concat(t.toString())),this},t.prototype.deleteCharAt=function(t){return this.str=this.str.slice(0,t)+this.str.slice(t+1,this.str.length),this},t.prototype.insert=function(t,e){return this.str=this.str.slice(0,t)+e+this.str.slice(t,this.str.length),this},t}();!function(t){t[t.NANOSECONDS=0]="NANOSECONDS",t[t.MICROSECONDS=1]="MICROSECONDS",t[t.MILLISECONDS=2]="MILLISECONDS",t[t.SECONDS=3]="SECONDS",t[t.MINUTES=4]="MINUTES",t[t.HOURS=5]="HOURS",t[t.DAYS=6]="DAYS"}(d||(d={})),function(t){t[t.NANOSECONDS=1]="NANOSECONDS",t[t.MICROSECONDS=1e3]="MICROSECONDS",t[t.MILLISECONDS=1e6]="MILLISECONDS",t[t.SECONDS=1e9]="SECONDS",t[t.MINUTES=6e10]="MINUTES",t[t.HOURS=36e11]="HOURS",t[t.DAYS=864e11]="DAYS"}(E||(E={}));var v=function(){function t(e){t.ordinals().indexOf(e)>-1?(this.timeOrdinal=e,this.timeUnit=d[e]):t.values().indexOf(e)>-1&&(this.timeOrdinal=t.values().indexOf(e),this.timeUnit=e)}return t.prototype.name=function(){return this.timeUnit},Object.defineProperty(t.prototype,"ordinal",{get:function(){return this.timeOrdinal},enumerable:!0,configurable:!0}),t.ordinals=function(){return Object.keys(d).filter(function(t){return"string"==typeof d[t]&&isFinite(+t)}).map(function(t){return parseInt(t)})},t.values=function(){return this.ordinals().map(function(e){return new t(e)})},t.prototype.valueOf=function(){return E[this.timeUnit]},t.prototype.toNanos=function(e){return t.NANOSECONDS.convert(e,this)},t.prototype.toMicros=function(e){return t.MICROSECONDS.convert(e,this)},t.prototype.toMillis=function(e){return t.MILLISECONDS.convert(e,this)},t.prototype.toSeconds=function(e){return t.SECONDS.convert(e,this)},t.prototype.toMinutes=function(e){return t.MINUTES.convert(e,this)},t.prototype.toHours=function(e){return t.HOURS.convert(e,this)},t.prototype.toDays=function(e){return t.DAYS.convert(e,this)},t.prototype.convert=function(t,e){return Math.trunc(t*e.valueOf()/this.valueOf())},t.NANOSECONDS=new t(d.NANOSECONDS),t.MICROSECONDS=new t(d.MICROSECONDS),t.MILLISECONDS=new t(d.MILLISECONDS),t.SECONDS=new t(d.SECONDS),t.MINUTES=new t(d.MINUTES),t.HOURS=new t(d.HOURS),t.DAYS=new t(d.DAYS),t}(),y=function(){function t(){}return t.formatNanos=function(e,r,n){return void 0===r&&(r=t.min()),void 0===n&&(n=t.max()),t.format(e,v.NANOSECONDS,r,n)},t.formatMillis=function(e,r,n){return void 0===r&&(r=t.min()),void 0===n&&(n=t.max()),t.format(e,v.MILLISECONDS,r,n)},t.format=function(e,r,n,i){void 0===n&&(n=t.min()),void 0===i&&(i=t.max());var o=new A,a="";e<0&&(e*=-1,a=" ago");for(var u=i;e>0;){var s=u.convert(e,r);if(s>0&&(e-=r.convert(s,u),o.append(s.toString()).append(" ").append(u.name().toLowerCase()),s<2&&o.deleteCharAt(o.length-1),o.append(", ")),u.ordinal===n.ordinal)break;u=v.values()[u.ordinal-1]}if(o.lastIndexOf(", ")<0)return"0 "+n.name().toLowerCase();o.deleteCharAt(o.length-1),o.deleteCharAt(o.length-1);var c=o.lastIndexOf(", ");return c>0&&(o.deleteCharAt(c),o.insert(c," and")),o.append(a),o.toString()},t.formatHighest=function(t,e,r){void 0===r&&(r=this.min());for(var n=v.values(),i=new A,o=e;t>0;){var a=o.convert(t,v.MILLISECONDS);if(a>0){t-=o.toMillis(a),i.append(a.toString()).append(" ").append(o.name().toLowerCase()),a<2&&i.deleteCharAt(i.length-1);break}if(o.ordinal===r.ordinal)break;o=n[o.ordinal-1]}return i.toString()},t.max=function(){var t=v.values();return t[t.length-1]},t.min=function(){return v.values()[0]},t.abbreviateString=function(t){return t=(t=(t=(t=(t=t.replace(new RegExp(" days?","ig"),"d")).replace(new RegExp(" hours?","ig"),"hr")).replace(new RegExp(" minutes?","ig"),"m")).replace(new RegExp(" seconds?","ig"),"s")).replace(new RegExp(" milliseconds?","ig"),"ms")},t.abbreviate=function(e,r,n,i){if(void 0===n&&(n=t.min()),void 0===i&&(i=t.max()),r&&"number"==typeof e){var o=t.format(e,r,n,i);return t.abbreviateString(o)}return"string"==typeof e?t.abbreviateString(e):"Wrong duration argument type "+typeof e},t}(),m=function(){function t(t,e){this.time=0,this.defaultErrorHandler=function(t){throw t},"string"!=typeof t&&t||("function"!=typeof e||1!=e.length)&&e?"number"!=typeof t&&t||"number"!=typeof e&&e?"number"==typeof t&&e instanceof v?(this.time=t,this.unit=e):this.invalidFormat(t,this.defaultErrorHandler):(this.time=t,this.unit=new v(e)):this.parseLongDuration(t,e)}return t.prototype.valueOf=function(){if(this.unit)return this.time*this.unit.valueOf();throw new Error("No timme unit")},t.prototype.parseLongDuration=function(e,r){for(var n=e.split(new RegExp(",| and ","ig")),i=new t(0,v.MILLISECONDS),o=0;o<n.length;o++){for(var a=n[o],u=new t(0,v.MILLISECONDS),s=a.trim(),c=new A,f=new A,h=0;h<s.length;h++){var l=s.charAt(h);if(!(/\d/.test(l[0])||0===h&&function(t){return null==t.charCodeAt?t:t.charCodeAt(0)}(l)=="-".charCodeAt(0)))break;c.append(l)}if(0===c.length)return void this.invalidFormat(s,this.defaultErrorHandler);for(;h<s.length;h++){l=s.charAt(h);if(!/[a-zA-Z ]/.test(l[0]))return void this.invalidFormat(s,this.defaultErrorHandler);f.append(l)}u.time=parseInt(c.toString()),u.unit=this.parseUnit(f.toString().trim(),this.defaultErrorHandler),null==u.unit&&(u.unit=v.MILLISECONDS),i=i.add(u)}this.time=i.time,this.unit=i.unit},t.prototype.getTime=function(t){return t.convert(this.time,this.unit)},t.prototype.equals=function(e){if(this===e)return!0;if(null==e||this.constructor!==e.constructor)return!1;var r=e,n=new t.Normalize(this,r);return n.a===n.b},t.prototype.hashCode=function(){var t=this.time^this.time>>>32|0;return t=31*t+this.unit.ordinal},t.prototype.add=function(e){var r=new t.Normalize(this,e);return new t(r.a+r.b,r.base)},t.prototype.subtract=function(e){var r=new t.Normalize(this,e);return new t(r.a-r.b,r.base)},t.prototype.invalidFormat=function(t,e){var r;"function"==typeof(r=e)?r(Object.defineProperty(new Error("Illegal duration format: '"+t+"'.  Valid examples are '10s' or '10 seconds'."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]})):r.accept(Object.defineProperty(new Error("Illegal duration format: '"+t+"'.  Valid examples are '10s' or '10 seconds'."),"__classes",{configurable:!0,value:["java.lang.Throwable","java.lang.Object","java.lang.RuntimeException","java.lang.IllegalArgumentException","java.lang.Exception"]}))},t.prototype.toString=function(){var t=new A;return t.append(this.time),null!=this.unit&&(t.append(" "),t.append(this.unit)),t.toString()},t.prototype.formatHighest=function(t){return void 0===t&&(t=y.max()),y.format(this.time,this.unit,v.MILLISECONDS,t)},t.prototype.parseUnit=function(t,e){if(0===t.length)throw new Error("Invalid unit");if(S("NANOSECONDS",t))return v.NANOSECONDS;if(S("NANOSECOND",t))return v.NANOSECONDS;if(S("NANOS",t))return v.NANOSECONDS;if(S("NANO",t))return v.NANOSECONDS;if(S("NS",t))return v.NANOSECONDS;if(S("MICROSECONDS",t))return v.MICROSECONDS;if(S("MICROSECOND",t))return v.MICROSECONDS;if(S("MICROS",t))return v.MICROSECONDS;if(S("MICRO",t))return v.MICROSECONDS;if(S("MILLISECONDS",t))return v.MILLISECONDS;if(S("MILLISECOND",t))return v.MILLISECONDS;if(S("MILLIS",t))return v.MILLISECONDS;if(S("MILLI",t))return v.MILLISECONDS;if(S("MS",t))return v.MILLISECONDS;if(S("SECONDS",t))return v.SECONDS;if(S("SECOND",t))return v.SECONDS;if(S("SEC",t))return v.SECONDS;if(S("S",t))return v.SECONDS;if(S("MINUTES",t))return v.MINUTES;if(S("MINUTE",t))return v.MINUTES;if(S("MIN",t))return v.MINUTES;if(S("M",t))return v.MINUTES;if(S("HOURS",t))return v.HOURS;if(S("HOUR",t))return v.HOURS;if(S("HRS",t))return v.HOURS;if(S("HR",t))return v.HOURS;if(S("H",t))return v.HOURS;if(S("DAYS",t))return v.DAYS;if(S("DAY",t))return v.DAYS;if(S("D",t))return v.DAYS;throw this.invalidFormat(t,e),new Error("Invalid format")},t}();!function(t){var e=function(){function t(e,r){this.a=0,this.b=0,this.base=t.lowest(e,r),this.a=null==e.unit?e.time:this.base.convert(e.time,e.unit),this.b=null==r.unit?r.time:this.base.convert(r.time,r.unit)}return t.lowest=function(t,e){return 0===t.time||null==t.unit?e.unit:0===e.time||null==e.unit?t.unit:v.values()[Math.min(t.unit.ordinal,e.unit.ordinal)]},t}();t.Normalize=e}(m||(m={}));var b=function(){function t(){}return t.join=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(0===e.length)return"";e[0]instanceof Array&&(e=e[0]);for(var n=new A,i=0,o=e;i<o.length;i++){var a=o[i];n.append(a).append(t)}return n.toString().substring(0,n.length-t.length)},t}(),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(o),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(o),N=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e}(o),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(o),I=function(){function t(){}return t.privateKeyFromPKCS8=function(t){try{return p.RSA.JWKfromRSA(p.AB2s(t),"private")}catch(t){throw new Error(t)}},t.privateKeyFromPKCS1=function(t){try{return p.RSA.JWKfromRSA(p.AB2s(t),"private")}catch(t){throw new Error(t)}},t.publicKeyFrom=function(t){try{return p.RSA.JWKfromRSA(p.AB2s(t),"public")}catch(t){throw new Error(t)}},t.RSA="RSA",t}(),R=function(){function t(t){this.str=t.split(/\r?\n/),this.cursor=0}return t.prototype.readline=function(t){t&&(this.cursor=t);var e=this.str.length>this.cursor?this.str[this.cursor]:null;return this.cursor++,e},t}(),D=function(){function t(){}return t.readPrivateKey=function(e){for(var r=0,n=t.readPEMObjects(e);r<n.length;r++){var i=n[r];switch(i.getPEMObjectType()){case P.PRIVATE_KEY_PKCS:return I.privateKeyFromPKCS1(i.getDerBytes());case P.PRIVATE_EC_KEY_PKCS8:return g.privateKeyFromPKCS8(i.getDerBytes());case P.PRIVATE_KEY_PKCS8:try{return I.privateKeyFromPKCS8(i.getDerBytes())}catch(t){return g.privateKeyFromPKCS8(i.getDerBytes())}}}throw new Error("Found no private key")},t.readPublicKey=function(e){for(var r=0,n=t.readPEMObjects(e);r<n.length;r++){var i=n[r];switch(i.getPEMObjectType()){case P.PUBLIC_KEY_X509:try{return I.publicKeyFrom(i.getDerBytes())}catch(t){return g.publicKeyFrom(i.getDerBytes())}}}throw new Error("Found no private key")},t.readPEMObjects=function(e){var r=new R(e);try{for(var n=[],i=!1,o="",a="",u=new A,s=void 0;null!=(s=r.readline());)i?s.includes(a)?(n.push(new M(o,p.s2AB(u.toString()))),i=!1):u.append(s.trim()):s.includes(t.BEGIN_MARKER)&&(i=!0,a=(o=s.trim()).replace("BEGIN","END"),u=new A);return n}finally{}},t.BEGIN_MARKER="-----BEGIN ",t}(),M=function(){function t(t,e){this.beginMarker=t,this.derBytes=e}return t.prototype.getBeginMarker=function(){return this.beginMarker},t.prototype.getDerBytes=function(){return this.derBytes[0]},t.prototype.getPEMObjectType=function(){return P.fromBeginMarker(this.beginMarker)},t}(),P=function(){function t(e){this.beginMarker=e,t.values.push(this)}return t.prototype.getBeginMarker=function(){return this.beginMarker},t.fromBeginMarker=function(e){return t.values.find(function(t){return t.getBeginMarker()===e})},t.values=[],t.PRIVATE_KEY_PKCS=new t("-----BEGIN RSA PRIVATE KEY-----"),t.PRIVATE_EC_KEY_PKCS8=new t("-----BEGIN EC PRIVATE KEY-----"),t.PRIVATE_KEY_PKCS8=new t("-----BEGIN PRIVATE KEY-----"),t.PUBLIC_KEY_X509=new t("-----BEGIN PUBLIC KEY-----"),t.CERTIFICATE_X509=new t("-----BEGIN CERTIFICATE-----"),t}(),H=function(t){function e(e,r){return t.call(this,e,r)||this}return n(e,t),e}(o),B=function(){function t(e,r,n){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];if(this.headers=["date"],null==e||0===e.trim().length)throw new Error("keyId is required.");if(null==r)throw new Error("algorithm is required.");this.keyId=e,this.algorithm="string"==typeof r?t.getAlgorithm(r):r,this.signature=n,0!==i.length&&(i[0]instanceof Array?this.headers=this.lowercase(i[0]):this.headers=this.lowercase(i)),this.headers=this.headers.slice(0)}return t.getAlgorithm=function(t){if(null==t)throw new Error("Algorithm cannot be null");return u.get(t)},t.prototype.lowercase=function(t){var e=[];for(var r in t)e.push(r.toLowerCase());return e},t.prototype.getKeyId=function(){return this.keyId},t.prototype.getAlgorithm=function(){return this.algorithm},t.prototype.getSignature=function(){return this.signature},t.prototype.getHeaders=function(){return this.headers},t.fromString=function(e){try{e=t.normalize(e);for(var r={},n={group:[]};null!==(n.group=this.RFC_2617_PARAM.exec(e));){var i=n.group[1].toLowerCase(),a=n.group[2];r.put(i,a)}var s=[],c=void 0===(S=r)[d="headers"]?null:S[d];null!=c&&(p=s,g=c.toLowerCase().split(" +").slice(0),p.push.apply(p,g));var f=function(t,e){return void 0===t[e]?null:t[e]}(r,"keyid");if(null==f)throw new C;var h=function(t,e){return void 0===t[e]?null:t[e]}(r,"algorithm");if(null==h)throw new w;var l=function(t,e){return void 0===t[e]?null:t[e]}(r,"signature");if(null==l)throw new O;return new t(f,u.get(h),l,s)}catch(t){if(null!=t&&t instanceof o)throw t;if(null!=t&&t instanceof Error)throw new H(e,t)}var p,g,S,d},t.normalize=function(t){var e,r,n="signature ",i=t.substring(0,n.length).toLowerCase();return r=n,((e=i)&&e.equals?e.equals(r):e===r)&&(t=t.substring(n.length)),t.trim()},t.prototype.toString=function(){return'Signature keyId="'+this.keyId+'",algorithm="'+this.algorithm+'",headers="'+b.join(" ",this.headers)+'",signature="'+this.signature+'"'},t.RFC_2617_PARAM=/(\\w+)=\"([^\"]*)\""/,t}(),U=function(){function t(){}return t.createSigningString=function(e,r,n,i){i=t.lowercase(i);for(var o=[],a=0,u=e;a<u.length;a++){var s=u[a];if("(request-target)"===s)r=t.lowercase(r),o.push(b.join(" ","(request-target):",r,n));else{var c=i[s];if(null==c)throw new N(s);o.push(s+": "+c)}}return b.join("\n",o)},t.lowercase$=function(e){return Object.keys(e).reduce(function(r,n){var i=e[n];return r[n.toLowerCase()]="object"==typeof i?t.lowercase$(i):i,r},{})},t.lowercase=function(e){return"string"==typeof e?e.toLowerCase():t.lowercase$(e)},t}();t.Algorithm=u,t.AuthenticationException=o,t.Base64=c,t.BufferedReader=R,t.Collection=f,t.EC=g,t.Join=b,t.MissingAlgorithmException=w,t.MissingKeyIdException=C,t.MissingRequiredHeaderException=N,t.MissingSignatureException=O,t.PEM=D,t.PEMObject=M,t.PEMObjectType=P,t.RSA=I,t.RuntimeException=i,t.Signature=B,t.Signatures=U,t.System=s,t.UnparsableSignatureException=H,t.UnsupportedAlgorithmException=a,Object.defineProperty(t,"__esModule",{value:!0})});
